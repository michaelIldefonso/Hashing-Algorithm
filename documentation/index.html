<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bishash Documentation</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>

<header>
    <div class="logo">
        <img class="logo-img" src="tupeNation.png" alt="Logo">
        <span class="logo-text">Bishash</span>
        <span class="logo-subtext">DOCUMENTATION</span>    
    </div>
    
</header>
<button class="burger" aria-label="Toggle navigation">
    &#9776;
</button>


<div class="container">
    <nav class="navbar">
        <button class="close" aria-label="Close navigation">&times;</button>
        <ul>
            <li><a href="#Overview">Overview</a></li>
            <li><a href="#Features">Features</a></li>
            <li><a href="#Requirements">Requirements</a></li>
            <li><a href="#Installation">Installation</a></li>
            <li><a href="#functions">Functions</a></li>
            <li><a href="#troubleshoot">Troubleshoot Guide</a></li>
            <li><a href="#testingFaq">FAQ and Testing</a></li>
        </ul>
    </nav>

    <div class="content">
        <div class="box">
            <h1 id="Overview">Overview</h1>
            <p>This documentation provides an overview of secure password management using Argon2 hashing, rate limiting, 
                and a strong password policy in Python. The following code enforces password strength and limits repeated 
                hashing attempts for added security.</p>
        </div>

        <div class="box">
            <h1 id="Features">Features</h1>
            <p class="disclaimer">
                <strong>Disclaimer:</strong> This documentation is intended for developers with experience in secure password handling and authentication. 
                The code examples provided are for educational purposes and may require additional configurations for production use.
            </p>
            
            <p>This module provides a robust implementation of password hashing and verification, ensuring enhanced security and rate-limiting mechanisms. Below are the detailed features:</p>
        
            <h2>1. Strong Password Policy Enforcement</h2>
            <p>The module includes a function <code>is_strong_password</code> that validates password strength based on the following criteria:</p>
            <ul>
                <li><strong>Minimum Length:</strong> Passwords must be at least 12 characters long.</li>
                <li><strong>Uppercase Letters:</strong> At least one uppercase letter is required.</li>
                <li><strong>Lowercase Letters:</strong> At least one lowercase letter is required.</li>
                <li><strong>Digits:</strong> At least one numeric digit is required.</li>
                <li><strong>Special Characters:</strong> At least one special character (e.g., <code>!@#$%^&*</code>) is required.</li>
            </ul>
        
            <h2>2. Secure Password Hashing</h2>
            <p>The module uses Argon2, a state-of-the-art password hashing algorithm, through the <code>argon2.PasswordHasher</code> class with the following configurations:</p>
            <ul>
                <li><strong>Time Cost:</strong> Configured to 8 iterations for computational expense.</li>
                <li><strong>Memory Cost:</strong> Allocates 64 MB (2<sup>16</sup> bytes) to prevent hardware attacks.</li>
                <li><strong>Parallelism:</strong> Set to 1 thread to avoid performance overheads in single-threaded environments.</li>
                <li><strong>Hash Length:</strong> Produces a 64-byte hash for increased security.</li>
                <li><strong>Salt Length:</strong> Uses a 16-byte random salt to prevent rainbow table attacks.</li>
            </ul>
        
            <h2>3. Peppering for Enhanced Security</h2>
            <p>The module incorporates a hard-coded <strong>pepper</strong> value, <code>PEPPER</code>, which is added to the identifier and password before hashing. This adds an extra layer of security to protect against targeted attacks even if the salt is known.</p>
        
            <h2>4. Rate Limiting on Hashing Attempts</h2>
            <p>The <code>bis_hash</code> function implements rate limiting to prevent abuse during sign-up or password changes:</p>
            <ul>
                <li><strong>Maximum Attempts:</strong> Limits to 5 hashing attempts per identifier per minute.</li>
                <li><strong>Request Throttling:</strong> If the limit is exceeded, the function raises an exception with the message <code>"Too many sign-up attempts. Please try again later."</code></li>
            </ul>
        
            <h2>5. Failed Login Attempt Tracking</h2>
            <p>The module tracks failed login attempts using an in-memory dictionary, <code>failed_attempts</code>, to prevent brute-force attacks:</p>
            <ul>
                <li><strong>Failed Attempts Storage:</strong> Tracks the timestamp of each failed login attempt for an identifier (e.g., email, username).</li>
                <li><strong>Lockout Mechanism:</strong> If the number of failed attempts exceeds <code>MAX_FAILED_ATTEMPTS</code> (set to 5 by default) within a defined <code>LOCKOUT_TIME</code> (10 minutes), the account is temporarily locked.</li>
            </ul>
        
            <h2>6. Account Lockout Feature</h2>
            <p>The <code>check_account_lock</code> function checks whether an identifier has reached the maximum number of failed attempts:</p>
            <ul>
                <li><strong>Lockout Condition:</strong> Returns <code>True</code> if the number of failed attempts for an identifier reaches or exceeds the <code>MAX_FAILED_ATTEMPTS</code> limit within the <code>LOCKOUT_TIME</code>.</li>
                <li><strong>Temporary Lockout:</strong> Prevents further login attempts for a specified period to protect against automated attacks.</li>
            </ul>
        
            <h2>7. Password Verification</h2>
            <p>The module provides a <code>verify_password</code> function to validate a user's password during login:</p>
            <ul>
                <li><strong>Lockout Check:</strong> Verifies if the identifier is currently locked before processing the login request.</li>
                <li><strong>Hash Comparison:</strong> Uses Argon2 to verify the entered password against the stored hash, combining the identifier, entered password, and pepper.</li>
                <li><strong>Exception Handling:</strong> Catches <code>VerifyMismatchError</code> for incorrect passwords and tracks the failed attempt.</li>
            </ul>
        
            <h2>8. In-Memory Storage for Attempt Tracking</h2>
            <p>The module utilizes Python's <code>defaultdict</code> from the <code>collections</code> module to maintain in-memory tracking of:</p>
            <ul>
                <li><strong>Failed Login Attempts:</strong> Stored in <code>failed_attempts</code> for login rate limiting and lockout enforcement.</li>
                <li><strong>Hashing Attempts:</strong> Stored in <code>bisHash_attempts</code> to enforce rate limiting during sign-up or password change processes.</li>
            </ul>
        
            <h2>9. Configurable Security Parameters</h2>
            <p>The module's security parameters are easily adjustable to meet specific requirements:</p>
            <ul>
                <li><strong>Time Cost, Memory Cost, and Parallelism:</strong> These Argon2 hashing parameters can be modified to balance security and performance.</li>
                <li><strong>Lockout Time and Maximum Failed Attempts:</strong> These values, set through <code>LOCKOUT_TIME</code> and <code>MAX_FAILED_ATTEMPTS</code>, can be configured based on the desired level of protection.</li>
                <li><strong>Pepper Value:</strong> The <code>PEPPER</code> can be customized to enhance the security against precomputed attacks.</li>
            </ul>
        </div>
        


        <div class="box">
            <h1 id="Requirements">Password Hashing Requirements</h1>

            <h2>Python Environment:</h2>
            <p>Ensure you have Python installed (preferably Python 3.6 or newer).</p>

            <h2>Required Libraries:</h2>
            <ul>
                <li><strong>argon2-cffi:</strong> This library is required to use the Argon2 password hashing algorithm.</li>
                <li><strong>ratelimit:</strong> This library is used to limit the number of calls to the <code>bis_hash</code> function, preventing abuse.</li>
                <li><strong>re:</strong> This is part of the standard library and is used for regular expression operations.</li>
            </ul>
            

            <h2>Hashing Parameters:</h2>
            <ul>
                <li><strong>time_cost:</strong> Specifies the number of iterations for the hashing process (increased time cost results in more security).</li>
                <li><strong>memory_cost:</strong> Defines the amount of memory (in bytes) the hashing algorithm can use (in your case, 2<sup>16</sup> bytes).</li>
                <li><strong>parallelism:</strong> The number of parallel threads (your implementation uses a single thread).</li>
                <li><strong>hash_len:</strong> The length of the resulting hash (set to 64 bytes in your implementation).</li>
                <li><strong>salt_len:</strong> The length of the random salt used in the hashing process (set to 16 bytes).</li>
            </ul>

            <h2>Password Policy:</h2>
            <ul>
                <li>Passwords must be at least 12 characters long.</li>
                <li>Passwords must contain:
                    <ul>
                        <li>At least one uppercase letter</li>
                        <li>At least one lowercase letter</li>
                        <li>At least one digit</li>
                        <li>At least one special character from the set <code>!@#$%^&*(),.?":{}|&lt;&gt;</code></li>
                    </ul>
                </li>
            </ul>

            <h2>Rate Limiting:</h2>
            <p>The <code>bis_hash</code> function is rate-limited to 5 calls per minute to prevent brute-force attacks.</p>

            <h2>Security Practices</h2>
            <ul>
                <li><strong>PEPPER:</strong> A static string that should not be exposed. It is added to the password and username before hashing. Ensure this value is kept secret.</li>
                <li><strong>Error Handling:</strong> Ensure proper handling of exceptions, especially during password verification.</li>
                <li><strong>Secure Environment:</strong> Use this implementation in a secure environment, where access to sensitive functions is restricted.</li>
            </ul>

            
        </div>

        <div class="box">
            <h1 id="Installation">Installation</h1>
            <p>You can install the necessary package using pip:</p>
            <pre>pip install bisHash</pre>

            <p>You can upgrade the algorithm using pip</p>
            <pre>pip install --upgrade bisHash</pre>

            <p>You can import the algorithm by entering this syntax:</p>
            <pre><code><span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span></code></pre>
        </div>
        
        <div class="box">
            <h1 id="functions">Functions</h1>
        
            <h2>bis_hash</h2>
            <pre><code>
                <span class="function">def</span> <span class="keyword">bis_hash</span>(<span class="keyword">identifier</span>, <span class="keyword">password</span>):
                    <span class="keyword">current_time</span> = <span class="keyword">time.time</span>()
                    
                    <span class="comment"># Clear out outdated attempts</span>
                    <span class="keyword">bisHash_attempts</span>[<span class="keyword">identifier</span>] = [
                        <span class="keyword">timestamp</span> 
                        <span class="keyword">for</span> <span class="keyword">timestamp</span> 
                        <span class="keyword">in</span> <span class="keyword">bisHash_attempts</span>[<span class="keyword">identifier</span>]
                        <span class="keyword">if</span> <span class="keyword">current_time</span> - <span class="keyword">timestamp</span> < <span class="keyword">ONE_MINUTE</span>
                    ]

                    <span class="comment"># Check if maximum attempts are exceeded</span>
                    <span class="keyword">if</span> <span class="keyword">len</span>(<span class="keyword">bisHash_attempts</span>[<span class="keyword">identifier</span>]) >= <span class="keyword">5</span>:
                        <span class="keyword">raise Exception</span>(<span class="string">"Too many sign-up attempts. Please try again later."</span>)

                    <span class="comment"># Log this attempt</span>
                    <span class="keyword">bisHash_attempts</span>[<span class="keyword">identifier</span>].<span class="keyword">append</span>(<span class="keyword">current_time</span>)

                    <span class="comment"># Perform the hash</span>
                    <span class="keyword">combined_input</span> = <span class="keyword">identifier</span> + <span class="keyword">password</span> + <span class="string">PEPPER</span>
                    <span class="keyword">return</span> <span class="keyword">ph.hash</span>(<span class="keyword">combined_input</span>)
            </code></pre>

            <p>The <code>bis_hash</code> function generates a secure hash for user registration while implementing rate limiting to prevent abuse. Here is a breakdown of its components:</p>
            <ul>
                <li><strong>Parameters:</strong>
                    <ul>
                        <li><code>identifier</code>: A user-specific identifier, such as a username, email, or ID number.</li>
                        <li><code>password</code>: The user's password to be hashed.</li>
                    </ul>
                </li>
                <li><strong>Rate Limiting:</strong>
                    <p>The function tracks recent hashing attempts using an in-memory dictionary <code>bisHash_attempts</code>. It checks for the number of attempts made within the past minute:</p>
                    <ul>
                        <li>If there are 5 or more attempts in the last minute for the same <code>identifier</code>, the function raises an exception to prevent further attempts.</li>
                        <li>This helps mitigate brute-force attacks by limiting the rate at which users can generate password hashes.</li>
                    </ul>
                </li>
                <li><strong>Combining Inputs:</strong>
                    <p>The function concatenates the <code>identifier</code>, <code>password</code>, and a secret <code>PEPPER</code> value to form the input for hashing. The pepper is a secret value known only to the application, adding an extra layer of security.</p>
                </li>
                <li><strong>Hashing:</strong>
                    <p>The <code>ph.hash()</code> method is used to create a secure hash from the combined input string.</p>
                </li>
            </ul>

        
            <h2>verify_password</h2>
            <pre><code>
                <span class="function">def</span> <span class="keyword">verify_password</span>(<span class="keyword">stored_hash</span>, <span class="keyword">identifier</span>, <span class="keyword">entered_password</span>):
                    <span class="keyword">combined_input</span> = <span class="keyword">identifier</span> + <span class="keyword">entered_password</span> + <span class="string">PEPPER</span>
                    <span class="keyword">try</span>:
                        <span class="keyword">ph.verify</span>(<span class="keyword">stored_hash</span>, <span class="keyword">combined_input</span>)
                        <span class="keyword">return</span> <span class="keyword">True</span>
                    <span class="keyword">except</span> <span class="keyword">VerifyMismatchError</span>:
                        <span class="keyword">return</span> <span class="keyword">False</span>
                </code></pre>
            <p>The <code>verify_password</code> function checks if a user's entered credentials match the stored password hash, serving a critical role in the authentication process:</p>
        
            <h3>Parameters:</h3>
            <ul>
                <li><strong>stored_hash:</strong> The hashed password retrieved from the database, created using the original password and identifier.</li>
                <li><strong>identifier:</strong> A unique identifier for the user, such as their username or email.</li>
                <li><strong>entered_password:</strong> The password input by the user during login.</li>
            </ul>
        
            <h3>Combining Inputs:</h3>
            <p>The function combines the identifier, the entered password, and the <code>PEPPER</code> value to form the input used for verification. This ensures consistency with the original hash generation process.</p>
        
            <h3>Verification Process:</h3>
            <ul>
                <li>Utilizes a try-except block for safe error handling during verification.</li>
                <li>The <code>ph.verify()</code> method compares the <code>stored_hash</code> with the computed hash of the combined input.</li>
                <li>Returns <code>True</code> if the input matches; otherwise, it catches the <code>VerifyMismatchError</code> and returns <code>False</code>.</li>
            </ul>
        
            <h2>is_strong_password</h2>
            <pre><code>
                <span class="function">def</span> <span class="keyword">is_strong_password</span>(<span class="keyword">password</span>):
                    <span class="keyword">if</span> <span class="keyword">len</span>(<span class="keyword">password</span>) < <span class="keyword">12</span>:
                        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">"Password must be at least 12 characters long."</span>
                    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">search</span>(<span class="string">r'[A-Z]'</span>, <span class="keyword">password</span>):
                        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">"Must contain at least one uppercase letter."</span>
                    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">search</span>(<span class="string">r'[a-z]'</span>, <span class="keyword">password</span>):
                        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">"Must contain at least one lowercase letter."</span>
                    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">search</span>(<span class="string">r'[0-9]'</span>, <span class="keyword">password</span>):
                        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">"Must contain at least one digit."</span>
                    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">search</span>(<span class="string">r'[!@#$%^&*(),.?":{}|<>]'</span>, <span class="keyword">password</span>):
                        <span class="keyword">return</span> <span class="keyword">False</span>, <span class="string">"Must contain at least one special character."</span>
                    <span class="keyword">return</span> <span class="keyword">True</span>, <span class="string">"Password is strong."</span>
                </code></pre>
            <p>The <code>is_strong_password</code> function assesses password strength based on security criteria, ensuring the password meets the following:</p>
            <ul>
                <li><strong>Minimum Length:</strong> At least 12 characters.</li>
                <li><strong>Uppercase Letter:</strong> Includes at least one uppercase letter.</li>
                <li><strong>Lowercase Letter:</strong> Includes at least one lowercase letter.</li>
                <li><strong>Digit:</strong> Includes at least one digit.</li>
                <li><strong>Special Character:</strong> Contains at least one special character (e.g., <code>!@#$%^&*(),.?":{}|&lt;&gt;</code>).</li>
            </ul>

            <h2>track_failed_attempt</h2>
            <pre><code>
                <span class="function">def</span> <span class="keyword">track_failed_attempt</span>(<span class="keyword">identifier</span>):
                    <span class="keyword">current_time</span> = <span class="keyword">time.time</span>()
                    <span class="comment"># Append current timestamp to failed attempts</span>
                    <span class="keyword">failed_attempts</span>[<span class="keyword">identifier</span>].<span class="keyword">append</span>(<span class="keyword">current_time</span>)
                    
                    <span class="comment"># Remove old failed attempts outside the lockout period</span>
                    <span class="keyword">failed_attempts</span>[<span class="keyword">identifier</span>] = [
                        <span class="keyword">timestamp</span>
                        <span class="keyword">for</span> <span class="keyword">timestamp</span> 
                        <span class="keyword">in</span> <span class="keyword">failed_attempts</span>[<span class="keyword">identifier</span>] 
                        <span class="keyword">if</span> <span class="keyword">current_time</span> - <span class="keyword">timestamp</span> < <span class="keyword">LOCKOUT_TIME</span>
                    ]
            </code></pre>
            
            <p>The <code>track_failed_attempt</code> function records failed login attempts for an identifier and helps in implementing rate limiting:</p>
            <ul>
                <li><strong>Parameters:</strong>
                    <ul>
                        <li><code>identifier</code>: A user-specific identifier, such as a username or email.</li>
                    </ul>
                </li>
                <li><strong>Failed Attempts Tracking:</strong>
                    <p>The function logs the current timestamp for each failed attempt in the <code>failed_attempts</code> dictionary and cleans up old entries outside the defined <code>LOCKOUT_TIME</code> window.</p>
                </li>
            </ul>

            <h2>check_account_lock</h2>
            <pre><code>
                <span class="function">def</span> <span class="keyword">check_account_lock</span>(<span class="keyword">identifier</span>):
                    <span class="keyword">if</span> <span class="keyword">len</span>(<span class="keyword">failed_attempts</span>[<span class="keyword">identifier</span>]) >= <span class="keyword">MAX_FAILED_ATTEMPTS</span>:
                        <span class="keyword">return</span> <span class="keyword">True</span>  <span class="comment"># Account is locked</span>
                    <span class="keyword">return</span> <span class="keyword">False</span>
            </code></pre>
            
            <p>The <code>check_account_lock</code> function checks whether an identifier should be locked out based on the number of failed attempts:</p>
            <ul>
                <li><strong>Parameters:</strong>
                    <ul>
                        <li><code>identifier</code>: A user-specific identifier, such as a username or email.</li>
                    </ul>
                </li>
                <li><strong>Lockout Check:</strong>
                    <p>The function compares the count of failed attempts against the defined <code>MAX_FAILED_ATTEMPTS</code>:</p>
                    <ul>
                        <li>Returns <code>True</code> if the number of failed attempts meets or exceeds the limit, indicating the account should be locked.</li>
                        <li>Returns <code>False</code> otherwise, allowing further login attempts.</li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <div class="box">
            <h1 id="troubleshoot">Troubleshooting Guide</h1>
            <h2>Overview</h2>
            <p>This guide helps resolve common issues related to the password hashing and rate-limiting module using Argon2.</p>
        
            <h2>1. Import Errors</h2>
            <h3>Problem</h3>
            <p>If you encounter errors like:</p>
            <pre><code class="error">
            ImportError: No module named 'ratelimit'
            ImportError: No module named 'argon2'
            </code></pre>
            <h3>Solution</h3>
            <p>Install the missing packages:</p>
            <pre><code class="bash">
            pip install argon2-cffi ratelimit
            </code></pre>
            <p>Ensure your Python environment is activated, and the packages are installed correctly.</p>
        
            <h2>2. Hash Generation Fails</h2>
            <h3>Problem</h3>
            <p>If <code>bis_hash()</code> throws an error like:</p>
            <pre><code class="error">
            Exception: Too many sign-up attempts. Please try again later.
            </code></pre>
            <h3>Solution</h3>
            <ul>
                <li>Verify that you are not exceeding the rate limit of 5 attempts per identifier per minute.</li>
                <li>Consider increasing the rate limit if necessary by adjusting the condition in the <code>bis_hash()</code> function:</li>
                <pre><code class="python">
                if len(bisHash_attempts[identifier]) >= 5:
                </code></pre>
            </ul>
        
            <h2>3. Password Verification Issues</h2>
            <h3>Problem</h3>
            <p>If <code>verify_password()</code> fails unexpectedly with <code>False</code> for correct credentials:</p>
            <pre><code class="error">
            VerifyMismatchError: The password does not match the stored hash.
            </code></pre>
            <h3>Solution</h3>
            <ul>
                <li>Check if the entered password is correct and matches the format stored in the hash function.</li>
                <li>Ensure the identifier (e.g., username or email) is also the same as used during hash generation.</li>
                <li>Verify that the pepper used is consistent across both hashing and verification:</li>
                <pre><code class="python">
                PEPPER = "jdafhpoahsofdashjp"
                </code></pre>
            </ul>
        
            <h2>4. Account Lockout Issues</h2>
            <h3>Problem</h3>
            <p>Users get locked out too quickly or fail to lock out after multiple incorrect attempts:</p>
            <pre><code class="error">
            Account locked: Too many failed login attempts.
            </code></pre>
            <h3>Solution</h3>
            <ul>
                <li>Check the <code>MAX_FAILED_ATTEMPTS</code> and <code>LOCKOUT_TIME</code> values:</li>
                <pre><code class="python">
                MAX_FAILED_ATTEMPTS = 5
                LOCKOUT_TIME = 10 * 60  # 10 minutes
                </code></pre>
                <li>Adjust these values based on your application's requirements.</li>
                <li>To reset failed attempts manually, clear the in-memory tracking for the user identifier:</li>
                <pre><code class="python">
                failed_attempts[identifier] = []
                </code></pre>
            </ul>
        
            <h2>5. Memory and Performance Issues</h2>
            <h3>Problem</h3>
            <p>If the system experiences high memory usage or slow performance during hash generation:</p>
            <h3>Solution</h3>
            <ul>
                <li>Reduce the <code>memory_cost</code> or <code>time_cost</code> in the PasswordHasher configuration:</li>
                <pre><code class="python">
                ph = PasswordHasher(
                    time_cost=8,  # Lower this to reduce CPU usage
                    memory_cost=2**16,  # Lower this to reduce memory usage
                    parallelism=1
                )
                </code></pre>
                <li>Be cautious, as lowering these values might reduce the security strength of the hashing function.</li>
            </ul>
        
            <h2>6. Pepper Key Issues</h2>
            <h3>Problem</h3>
            <p>If all password verifications fail consistently:</p>
            <h3>Solution</h3>
            <ul>
                <li>Ensure that the same pepper is used for both hashing and verifying:</li>
                <pre><code class="python">
                PEPPER = "jdafhpoahsofdashjp"
                </code></pre>
                <li>For enhanced security, avoid hardcoding the pepper in the source code. Consider using an environment variable:</li>
                <pre><code class="bash">
                export PEPPER_KEY="your-secret-pepper"
                </code></pre>
                <pre><code class="python">
                PEPPER = os.getenv("PEPPER_KEY", "default_pepper")
                </code></pre>
            </ul>
        
            <h2>7. Rate-Limiting Not Working</h2>
            <h3>Problem</h3>
            <p>If rate-limiting is not effectively blocking excessive attempts:</p>
            <h3>Solution</h3>
            <ul>
                <li>Verify that the <code>track_failed_attempt()</code> is called within <code>verify_password()</code> upon a failed attempt.</li>
                <li>Ensure the current time and failed attempts list are managed correctly:</li>
                <pre><code class="python">
                current_time = time.time()
                failed_attempts[identifier].append(current_time)
                </code></pre>
            </ul>
        
            <h2>Need More Help?</h2>
            <p>If issues persist, consider enabling logging for deeper analysis. Add the following at the start of your script:</p>
            <pre><code class="python">
            import logging
            logging.basicConfig(level=logging.DEBUG)
            </code></pre>
        </div>
        

        <div class="box">
            <h1 id="testingFaq">FAQ and Testing</h1>
            <h2>FAQ</h2>
            <h3>Why use a pepper in addition to salt?</h3>
            <p>Peppers provide an extra layer of security in case of database breaches, as they are stored separately from user-specific salts.</p>

            <h3>How does rate-limiting improve security?</h3>
            <p>Rate-limiting prevents brute-force attacks by slowing down the rate at which hash attempts can be made, adding further protection against password cracking.</p>

            <h3>Why choose Argon2 over bcrypt or PBKDF2?</h3>
            <p>Argon2 is memory-hard and designed specifically to resist attacks by dedicated hardware like GPUs, making it a preferred choice for strong password hashing.</p>

            <h2>Test Coverage Suggestions</h2>
            <p>Consider testing the following scenarios:</p>
            <ul>
                <li>Short and extremely long passwords</li>
                <li>Unusual or complex character combinations</li>
                <li>Handling of usernames with special or non-ASCII characters</li>
                <li>Testing lockout after multiple failed attempts</li>
                <li>Rate limiting checks during rapid hash generation attempts</li>
            </ul>

            <h3>Sample Test Cases for Password Strength, Hashing, and Security</h3>
            <pre><code><span class="comment"># Import necessary modules</span>
            <span class="keyword">import</span> <span class="keyword">time</span>
            <span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span>

            <span class="comment"># Test Variables</span>
            <span class="keyword">username</span> = <span class="string">"test_user"</span>
            <span class="keyword">strong_password</span> = <span class="string">"StrongPassword123!"</span>
            <span class="keyword">weak_password</span> = <span class="string">"weak"</span>
            <span class="keyword">complex_password</span> = <span class="string">"P@$$w0rd!#$%^&*"</span>
            <span class="keyword">unicode_username</span> = <span class="string">"ユーザー名"</span>

            <span class="comment"># 1. Password Strength Check</span>
            <span class="function">assert</span> <span class="function">is_strong_password</span>(<span class="keyword">weak_password</span>)[0] == <span class="keyword">False</span>
            <span class="function">assert</span> <span class="function">is_strong_password</span>(<span class="keyword">strong_password</span>)[0] == <span class="keyword">True</span>
            <span class="function">assert</span> <span class="function">is_strong_password</span>(<span class="keyword">complex_password</span>)[0] == <span class="keyword">True</span>

            <span class="comment"># 2. Hash Generation and Verification</span>
            <span class="keyword">hashed_password</span> = <span class="function">bis_hash</span>(<span class="keyword">username</span>, <span class="keyword">strong_password</span>)
            <span class="function">assert</span> <span class="function">verify_password</span>(<span class="keyword">hashed_password</span>, <span class="keyword">username</span>, <span class="keyword">strong_password</span>) == <span class="keyword">True</span>
            <span class="function">assert</span> <span class="function">verify_password</span>(<span class="keyword">hashed_password</span>, <span class="keyword">username</span>, <span class="string">"wrong_password"</span>) == <span class="keyword">False</span>

            <span class="comment"># 3. Handling Special and Non-ASCII Characters</span>
            <span class="keyword">hashed_unicode</span> = <span class="function">bis_hash</span>(<span class="keyword">unicode_username</span>, <span class="keyword">complex_password</span>)
            <span class="function">assert</span> <span class="function">verify_password</span>(<span class="keyword">hashed_unicode</span>, <span class="keyword">unicode_username</span>, <span class="keyword">complex_password</span>) == <span class="keyword">True</span>

            <span class="comment"># 4. Lockout Mechanism</span>
            <span class="function">for</span> <span class="keyword">_</span> <span class="keyword">in</span> <span class="function">range</span>(<span class="number">5</span>):
                <span class="function">verify_password</span>(<span class="keyword">hashed_password</span>, <span class="keyword">username</span>, <span class="string">"wrong_password"</span>)

            <span class="function">assert</span> <span class="function">check_account_lock</span>(<span class="keyword">username</span>) == <span class="keyword">True</span>

            <span class="comment"># 5. Rate Limiting During Hash Generation</span>
            <span class="keyword">try</span>:
                <span class="function">for</span> <span class="keyword">_</span> <span class="keyword">in</span> <span class="function">range</span>(<span class="number">6</span>):  <span class="comment"># Exceed max attempts quickly</span>
                    <span class="function">bis_hash</span>(<span class="keyword">username</span>, <span class="keyword">strong_password</span>)
                    <span class="function">time.sleep</span>(<span class="number">1</span>)
                <span class="function">print</span>(<span class="string">"Rate limiting failed!"</span>)
            <span class="keyword">except</span> <span class="function">Exception</span> <span class="keyword">as</span> e:
                <span class="function">assert</span> <span class="string">"Too many sign-up attempts"</span> <span class="keyword">in</span> <span class="function">str</span>(e)

            <span class="function">print</span>(<span class="string">"All tests passed successfully!"</span>)
            </code></pre>

            <h2>Other Sample Scenarios</h2>
            <h3>Password is not strong enough</h3>
            <pre><code><span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span>
                <span class="keyword">username:</span> <span class="string">"miko123"</span>
                <span class="keyword">Email:</span> <span class="string">"miko123@gmail.com"</span>
                <span class="keyword">Password:</span> <span class="string">weak</span>
                <span class="comment"># Expected Output</span>
                <span class="error">"Password does not meet strength requirements."</span>
            </code></pre>

            <h3>Successful Hashing</h3>
            <pre><code><span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span>
                <span class="comment">Sign up sample</span>
                <span class="keyword">username:</span> <span class="string">"miko123"</span>
                <span class="keyword">Email:</span> <span class="string">"miko123@gmail.com"</span>
                <span class="keyword">Password:</span> <span class="string">"StrongPassword123"</span>
                
                <span class="comment"># Expected Hashed Password</span>
                <span class="keyword">Expected hashed_password:</span> <span class="string">$argon2id$v=19$m=65536,t=12,p=1$0yTpXqY2PzpgLu8pN8fxKg$u0CVOOwywmEy+paA
                    BuXm5KfrYoq5OWzRtCj1rHSRbUpY1WDZSnU7bov9TAMp7jjMKBq+Zz7Z4HnINDH0HBQceg</span>
            </code></pre>
            
            <h3>Verifying Password</h3>
            <pre><code><span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span>
                <span class="comment">Registered User</span>
                <span class="keyword">Email:</span> <span class="string">"miko123@gmail.com"</span>
                <span class="keyword">Password:</span> <span class="string">"StrongPassword123"</span>
                <span class="comment"># Expected Hashed Password</span>
                <span class="keyword">Expected hashed_password:</span> <span class="string">$argon2id$v=19$m=65536,t=8,p=1$K6iZTYXfu8U/UEWYzycdqg$Ased/67LNA78SiWqY4zC1HRhGEb0yyaID5JcIIKNBHLEWIlO8oOw/OzLWaMI+poJEODQqKTgp8mIP3q4kAlKwA</span>
                
                <span class="comment">Sample Log In</span>
                <span class="keyword">Email:</span> <span class="string">"miko123@gmail.com"</span>
                <span class="keyword">Password:</span> <span class="string">"WrongPassword"</span>
                <span class="comment"># Expected Output</span>
                <span class="error">"Invalid credentials"</span>
            </code></pre>
            
            <h3>Locked Account</h3>
            <pre><code><span class="keyword">from</span> <span class="function">bisHash.hashing</span> <span class="keyword">import</span> <span class="function">bis_hash</span>, <span class="function">verify_password</span>, <span class="function">is_strong_password</span>, <span class="function">track_failed_attempt</span>, <span class="function">check_account_lock</span>
                <span class="comment">Simulate log-in attempts</span>
                <span class="keyword">Email:</span> <span class="string">"miko123@gmail.com"</span>
                <span class="keyword">Password:</span> <span class="string">"WrongPassword"</span>
                <span class="comment">After too many attempts on Log-in</span>

                <span class="comment"># Expected Output</span>
                <span class="error">"Too many failed login attempts. Please try again later."</span>
            </code></pre>
        </div>
    </div>
</div>
    
    <footer class="footer">
        <p>&copy; 2024 Bishash. All rights reserved.</p>
    </footer>

    <script src="script.js"></script>
</body>

</html>
